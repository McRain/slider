"use strict";(self.webpackChunk_reneos_3d_mod_tweens=self.webpackChunk_reneos_3d_mod_tweens||[]).push([[84,234],{59:(e,t,o)=>{o.d(t,{A:()=>B});var a=o(27);const l={class:"flex-line"},i={class:"line-title"},n={class:"value-title"},r={value:"accurate"},s={value:"relative"},d={class:"flex-fit"},c={class:"flex-line"},p={class:"line-title"},u={class:"value-title"},m={value:"accurate"},y={value:"relative"},h={class:"flex-fit"},v={class:"flex-line"},f={class:"line-title"},g={class:"value-title"},V={class:"flex-line"},N={class:"line-title"},E={class:"value-title"},w={class:"flex-line"},b={class:"value-title"},k={class:"flex-line"},x={class:"value-title"},$=["checked"],C={class:"flex-line"};var z=o(652);const A={name:"TweenUI",props:{labels:{type:Object},property:{type:String},name:{type:String},from:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},to:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},delay:{type:Number},time:{type:Number},easing:{type:String,default:"Easing.Linear.InOut"},repeat:{type:Number},yoyo:{type:Boolean},options:{type:Object,default:{inspector:!1}}},computed:{fromtype:{get(){return this.from.type},set(e){this.$emit("update","from",{value:this.fromvalue,type:e})}},fromvalue:{get(){return this.from.value},set(e){this.$emit("update","from",{value:e,type:this.fromtype})}},totype:{get(){return this.to.type},set(e){this.$emit("update","to.type",e)}},tovalue:{get(){return this.to.value},set(e){this.$emit("update","to",{value:e,type:this.totype})}},easingval:{get(){return this.easing},set(e){this.$emit("update","easing",e)}},target(){return this.$app.selection.selected}},methods:{copyFromModel(e){const t=this.target.model[this.property].clone(),o=this[e];o.value.x=t.x,o.value.y=t.y,o.value.z=t.z,this.$emit("update",e,o)},reset(){const e=this.target[this.property]||this.target.model[this.property];this.target.model?this.target.model[this.property].copy(e):this.target[this.property].copy(e)},async play(){if(this.played)return this.played=!1,void this.$emit("play",this.played);this.played=!0,this.$emit("play",this.played),this.reset(),await TweenPos({from:this.from,to:this.to,delay:this.delay,time:this.time,easing:this.easing,repeat:this.repeat,yoyo:this.yoyo},this.target,!1),this.played=!1,this.$emit("play",this.played)}},components:{RepeatSelector:z.A}},B=(0,o(262).A)(A,[["render",function(e,t,o,z,A,B){const T=(0,a.resolveComponent)("icon"),U=(0,a.resolveComponent)("V3"),S=(0,a.resolveComponent)("Float"),O=(0,a.resolveComponent)("RepeatSelector");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createElementVNode)("div",l,[(0,a.createElementVNode)("div",i,[t[11]||(t[11]=(0,a.createTextVNode)("Из: ")),o.options.inspector&&["accurate"].includes(o.from.type)?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:t[0]||(t[0]=e=>B.copyFromModel("from"))},[(0,a.createVNode)(T,{value:"target",size:"0.9em"})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",n,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>B.fromtype=e)},[(0,a.createElementVNode)("option",r,(0,a.toDisplayString)(o.labels.accurate),1),(0,a.createElementVNode)("option",s,(0,a.toDisplayString)(o.labels.relative),1)],512),[[a.vModelSelect,B.fromtype]])])]),(0,a.createElementVNode)("div",d,[["accurate","relative"].includes(o.from.type)?((0,a.openBlock)(),(0,a.createBlock)(U,{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>B.fromvalue=e),step:.1,modelValue:B.fromvalue},null,8,["modelValue"])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",p,[t[12]||(t[12]=(0,a.createTextVNode)("В:")),o.options.inspector&&["accurate"].includes(o.to.type)?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:t[3]||(t[3]=e=>B.copyFromModel("to"))},[(0,a.createVNode)(T,{value:"target",size:"0.9em"})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",u,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>B.totype=e)},[(0,a.createElementVNode)("option",m,(0,a.toDisplayString)(o.labels.accurate),1),(0,a.createElementVNode)("option",y,(0,a.toDisplayString)(o.labels.relative),1)],512),[[a.vModelSelect,B.totype]])])]),(0,a.createElementVNode)("div",h,[["accurate","relative"].includes(o.to.type)?((0,a.openBlock)(),(0,a.createBlock)(U,{key:0,"onUpdate:modelValue":t[5]||(t[5]=e=>B.tovalue=e),step:.1,modelValue:B.tovalue},null,8,["modelValue"])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("div",f,(0,a.toDisplayString)(o.labels.delay)+": ",1),(0,a.createElementVNode)("div",g,[(0,a.createVNode)(S,{modelValue:o.delay,min:0,decimals:0,step:10,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$emit("update","delay",t))},null,8,["modelValue"])])]),(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("div",N,(0,a.toDisplayString)(o.labels.time)+": ",1),(0,a.createElementVNode)("div",E,[(0,a.createVNode)(S,{modelValue:o.time,min:0,decimals:0,step:10,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$emit("update","time",t))},null,8,["modelValue"])])]),(0,a.createElementVNode)("div",w,[t[14]||(t[14]=(0,a.createElementVNode)("div",{class:"line-title"},"Затухание: ",-1)),(0,a.createElementVNode)("div",b,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>B.easingval=e)},t[13]||(t[13]=[(0,a.createElementVNode)("option",{value:"Easing.Linear.InOut"},"Linear In Out",-1),(0,a.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Quadratic Out",-1),(0,a.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Cubic Out",-1)]),512),[[a.vModelSelect,B.easingval]])])]),(0,a.createElementVNode)("div",k,[t[15]||(t[15]=(0,a.createElementVNode)("div",{class:"line-title"},"Замыкание:",-1)),(0,a.createElementVNode)("div",x,[(0,a.createElementVNode)("input",{checked:o.yoyo,onChange:t[9]||(t[9]=t=>e.$emit("update","yoyo",t.target.checked)),type:"checkbox"},null,40,$)])]),(0,a.createElementVNode)("div",C,[t[16]||(t[16]=(0,a.createElementVNode)("div",null,"Повторы:",-1)),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(O,{repeat:o.repeat,"onUpdate:repeat":t[10]||(t[10]=t=>e.$emit("update","repeat",t))},null,8,["repeat"])])])])}]])},70:(e,t,o)=>{o.d(t,{A:()=>n});const a=new(o(816).Group);let l=!1;class i{static get Group(){return a}static Add(e){a.add(e),l||(l=!0,i.Update())}static Remove(e){a.remove(e),0===a.getAll().length&&(l=!1)}static Update(e){l&&(a.update(e),requestAnimationFrame(i.Update))}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static ToRadiansV3(e){return{x:e.x*Math.PI/180,y:e.y*Math.PI/180,z:e.z*Math.PI/180}}}const n=i},222:(e,t,o)=>{o.r(t),o.d(t,{default:()=>c});var a=o(27);const l={class:"vertflex"},i={class:"flex-fit",style:{"justify-content":"center"}},n={key:0,class:"flex-fit",style:{"justify-content":"center"}};var r=o(470),s=o(59);const d={name:"TweenRotate",props:{name:{type:String},from:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},to:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},delay:{type:Number},time:{type:Number},easing:{type:String,default:"Easing.Linear.InOut"},repeat:{type:Number},yoyo:{type:Boolean},options:{type:Object,default:{inspector:!1}}},data:()=>({labels:{accurate:"Точное вращение",relative:"Относительное вращение",delay:"Отсрочка (мсек)",time:"Время (мсек)"},played:!1}),computed:{fromtype:{get(){return this.from.type},set(e){this.$emit("update","from",{value:this.fromvalue,type:e})}},fromvalue:{get(){return this.from.value},set(e){this.$emit("update","from",{value:e,type:this.fromtype})}},totype:{get(){return this.to.type},set(e){this.$emit("update","to.type",e)}},tovalue:{get(){return this.to.value},set(e){this.$emit("update","to",{value:e,type:this.totype})}},easingval:{get(){return this.easing},set(e){this.$emit("update","easing",e)}},target(){return this.$app.selection.selected}},methods:{onUpdate(e,t){this.$emit("update",e,t)},copyFromModel(e){const t=this.target.model.rotation.clone();e.value.x=t.x,e.value.y=t.y,e.value.z=t.z},reset(){const e=this.target.rotation||this.target.model.rotation;this.target.model?this.target.model.rotation.copy(e,"XYZ"):this.target.rotation.copy(e,"XYZ")},async play(){if(this.played)return this.played=!1,void this.$emit("play",this.played);this.played=!0,this.$emit("play",this.played),this.reset(),await(0,r.default)({from:this.from,to:this.to,delay:this.delay,time:this.time,easing:this.easing,repeat:this.repeat,yoyo:this.yoyo},this.target,!1),this.played=!1,this.$emit("play",this.played)}},components:{TweenUI:s.A}},c=(0,o(262).A)(d,[["render",function(e,t,o,r,s,d){const c=(0,a.resolveComponent)("TweenUI"),p=(0,a.resolveComponent)("icon");return(0,a.openBlock)(),(0,a.createElementBlock)("div",l,[(0,a.createElementVNode)("div",i,[(0,a.renderSlot)(e.$slots,"default")]),(0,a.createVNode)(c,{labels:s.labels,property:"rotation",name:o.name,from:o.from,to:o.to,delay:o.delay,time:o.time,easing:o.easing,repeat:o.repeat,yoyo:o.yoyo,options:o.options,onUpdate:d.onUpdate},null,8,["labels","name","from","to","delay","time","easing","repeat","yoyo","options","onUpdate"]),o.options.inspector?((0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createElementVNode)("button",{class:"square",onClick:t[0]||(t[0]=t=>e.$emit("play"))},[(0,a.createVNode)(p,{value:s.played?"stop2":"play3",size:"1.2em"},null,8,["value"])]),(0,a.createElementVNode)("button",{onClick:t[1]||(t[1]=t=>e.$emit("reset"))},[(0,a.createVNode)(p,{value:"undo",size:"1em"})]),(0,a.createElementVNode)("button",{onClick:t[2]||(t[2]=t=>e.$emit("remove"))},[(0,a.createVNode)(p,{value:"bin",size:"1em"})])])):(0,a.createCommentVNode)("v-if",!0)])}]])},262:(e,t)=>{t.A=(e,t)=>{const o=e.__vccOpts||e;for(const[e,a]of t)o[e]=a;return o}},470:(e,t,o)=>{o.r(t),o.d(t,{default:()=>r});var a=o(816),l=o(70),i=o(500);const n=`${Date.now()}_${Math.random()}`;function r(e,t,o=!1){return new Promise((r=>{e.tween&&e.tween.uid===n&&(e.tween.stop(),l.A.Remove(e.tween));let s=t;try{e.paths&&e.paths.forEach((e=>{if(!s)throw new Error(`Target is null at path ${e}`);s=s[e]})),e.target&&e.target.forEach((e=>{if(!s?.children)throw new Error("No children in target");const t=s.children.find((t=>t.uid===e));if(!t)throw new Error(`Child with uid ${e} not found`);s=t}))}catch(e){return console.error("Target resolution error:",e),r()}if(!s?.model)return console.error("Target model not found"),r();const d=(e,t,o)=>{const a="accurate"===t?l.A.ToRadiansV3({...e}):{x:(o?.x||0)+l.A.ToRadians(e?.x||0),y:(o?.y||0)+l.A.ToRadians(e?.y||0),z:(o?.z||0)+l.A.ToRadians(e?.z||0)};return new i.Euler(a.x,a.y,a.z,"XYZ")};let c=e.rotation||s.data?.rotation||s.model.data?.rotation;if("target"===e.to?.type)try{let o=t.slide||t;for(const t of e.to.paths||[]){if(!o?.children)throw new Error("No children in intermediate target");if(o=o.children.find((e=>e.uid===t)),!o)throw new Error(`Target with uid ${t} not found`)}c=o.rotation||o.model.rotation}catch(e){return console.error("Target rotation resolution error:",e),r()}const p=d(e.from.value,e.from.type,s.model.rotation),u=d(e.to?.value||{},e.to?.type,c),m=(new i.Quaternion).setFromEuler(p),y=(new i.Quaternion).setFromEuler(u),h=m.clone();s.model.quaternion.copy(m);const v={t:0};e.tween=new a.Tween(v).to({t:1},o?0:e.time||1e3).delay(o?0:e.delay||0).easing(a.Easing.Quadratic.InOut).yoyo(Boolean(e.yoyo)).repeat(e.repeat||0).onUpdate((()=>{h.copy(m).slerp(y,v.t),s.model.quaternion.copy(h)})).onComplete((()=>{l.A.Remove(e.tween),e.tween=null,r()})).onStop((()=>{l.A.Remove(e.tween),e.tween=null,r()})),e.tween.uid=n,l.A.Add(e.tween),e.tween.start()}))}},652:(e,t,o)=>{o.d(t,{A:()=>n});var a=o(27);const l={style:{display:"flex","flex-wrap":"nowrap",gap:"10px","justify-content":"flex-end"}},i={props:{repeat:{type:[Number],required:!0}},computed:{rep:{get(){return this.repeat},set(e){this.$emit("update:repeat",e)}}},watch:{infin(e){this.$emit("update:repeat",e?1/0:this.inputRepeat)}},data(){return{inputRepeat:this.repeat,infin:!1}}},n=(0,o(262).A)(i,[["render",function(e,t,o,i,n,r){const s=(0,a.resolveComponent)("icon");return(0,a.openBlock)(),(0,a.createElementBlock)("div",l,[n.infin?(0,a.createCommentVNode)("v-if",!0):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:0,style:{width:"42px",height:"0.98em"},type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>r.rep=e),min:"0"},null,512)),[[a.vModelText,r.rep,void 0,{number:!0}]]),(0,a.createVNode)(s,{style:(0,a.normalizeStyle)({opacity:n.infin?1:.5}),value:"infinite",size:"1em"},null,8,["style"]),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.infin=e),type:"checkbox"},null,512),[[a.vModelCheckbox,n.infin]])])}]])}}]);