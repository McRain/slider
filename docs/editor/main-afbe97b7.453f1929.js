"use strict";(self.webpackChunk_reneos_3d_editor=self.webpackChunk_reneos_3d_editor||[]).push([[806],{3822:(e,t,n)=>{n.d(t,{A:()=>M});var o=n(2064),s=n(5216),i=n(125);const a=new i.Raycaster,c=new class{constructor(){this._events={"*":[]}}subs(e,t,n){null==this._events[e]&&(this._events[e]=[]),this._events[e].push({handler:n,once:t})}on(e,t){this.subs(e,!1,t)}once(e,t){this.subs(e,!0,t)}off(e,t){const n=this._events[e];if(n){for(let e=n.length-1;e>=0;e--)n[e].handler===t&&n.splice(e,1);0===n.length&&delete this._events[e]}}clear(e){this._events[e]=[]}clearAll(){this._events={"*":[]}}emit(e,...t){const n=[];this._events[e]&&n.push(...this._events[e]),this._events["*"].length&&n.push(...this._events["*"].map((t=>({handler:t.handler.bind(this,e),once:t.once}))));for(let e=n.length-1;e>=0;e--){const o=n[e];o.handler.apply(null,t),o.once&&n.splice(e,1)}}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}};let r,l,d,p;const h={x:0,y:0};let u,m=.03,w=.03,g=.01,v=.01,y=window.innerWidth/2,b=window.innerHeight/2;function f(e){for(;e;){if(e.isElement)return e;e=e.parent}return null}function _(e){}function S(e){h.x=e.clientX,h.y=e.clientY,u=Date.now()}function E(e){if(Math.abs(h.x-e.clientX)>10||Math.abs(h.y-e.clientY)>10||Date.now()-u>500)return;const t=new i.Vector2,n=p.getBoundingClientRect(),o=e.clientX-n.left,s=e.clientY-n.top;t.x=o/p.clientWidth*2-1,t.y=-s/p.clientHeight*2+1,a.setFromCamera(t,l);const d=a.intersectObjects(r.children,!0);if(0!==d.length)for(let e=0;e<d.length;e++){const t=f(d[e].object);if(t.visible)return void c.emit("click",t)}else c.emit("click",null)}const k=new Proxy(class{static get Control(){return Control}static Init(e,t,n,o,s){const i={camera:{range:{x:.01,y:.01},movespeed:{x:.03,y:.03}},...s};r=o,d=n,l=t,p=e,m=i.camera.movespeed.x,w=i.camera.movespeed.y,g=i.camera.range.x,v=i.camera.range.y,y=window.innerWidth/2,b=window.innerHeight/2,e.addEventListener("click",E.bind(null)),e.addEventListener("mousemove",_,!1),e.addEventListener("mousedown",S,!1)}static Update(e){}static SetCamera(e){l=e}},{get:(e,t)=>t in e?e[t]:c[t]}),x=o.default||o;let C,H,L,W;function R(e){H.render(C,L)}const M=class{static async Init(e){W=e;const{THREE:t,ProjectManager:n}=await x.modules.load("engine","engine");C=n.Scene,H=new t.WebGLRenderer({canvas:e,alpha:!0,powerPreference:"high-performance",antialias:!0,stencil:!1});const o=W.clientWidth,i=W.clientHeight;H.setSize(o,i,!1),H.setPixelRatio(window.devicePixelRatio);const a=new t.CameraHelper(n.Camera);a.layers.set(1),C.add(a),L=new t.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,5e3),L.uid="EditorCamera",C.add(L),L.position.set(5,3,20),H.setAnimationLoop(R),L.layers.enable(1),s.A.Init({canvas:W},L,n.Scene),s.A.FocusTo(n.Root),k.Init(W,L,C,n.Root),k.on("click",(e=>{x.selection.select(e)}))}}},4215:(e,t,n)=>{n.d(t,{A:()=>i});const o=document.createElement("div");let s;o.className="tooltip",o.style.position="absolute",o.style.visibility="hidden",document.body.appendChild(o);const i={beforeMount(e,t){const n=()=>{s=e,o.textContent=t.value;const n=e.getBoundingClientRect();let i=n.left+window.scrollX+n.width/2-o.offsetWidth/2,a=n.top+window.scrollY-o.offsetHeight-5;i+o.offsetWidth>window.innerWidth&&(i=window.innerWidth-o.offsetWidth-10),i<0&&(i=10),a+o.offsetHeight>window.innerHeight&&(a=n.top+window.scrollY+n.height+5),a<0&&(a=n.top+window.scrollY+n.height+5),o.style.left=`${i}px`,o.style.top=`${a}px`,o.style.visibility="visible"},i=()=>{s===e&&(o.style.visibility="hidden")};e.__tooltipHandlers__={mouseEnterHandler:n,mouseLeaveHandler:i},e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",i)},unmounted(e){const{mouseEnterHandler:t,mouseLeaveHandler:n}=e.__tooltipHandlers__||{};t&&e.removeEventListener("mouseenter",t),n&&e.removeEventListener("mouseleave",n),s===e&&(o.style.visibility="hidden")}}},5216:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(7024),s=n(125),i=n(5e3),a=n(9338);let c,r,l;function d(){const e=r.object;c.update();const t=new s.Box3;e.traverse((e=>{t.expandByObject(e)}));const n=new s.Sphere;t.getBoundingSphere(n),p.FitTo(n)}class p{static FocusToSelect(){r.object&&d()}static FocusTo(e){c.target.copy(e.isObject3D?e.position:e)}static MoveTo(e,t){const n={position:new s.Vector3,time:1e3,...e,control:!1},o={position:new s.Vector3,time:1e3,...t,control:!1};c.enabled=!1;const i=Workspace.Camera.position.clone(),a=c.target.clone();n.control=n.time>o.time,o.control=o.time>=n.time;const r=new Tween(i).to(n.position,n.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{Workspace.Camera.position.copy(i),Workspace.Camera.updateProjectionMatrix(),c.update()})).onComplete((()=>{n.control&&(c.enabled=!0),tweengroup.remove(r)})).start(),l=new Tween(a).to(o.position,o.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{c.target.copy(a),c.getPolarAngle()>c.maxPolarAngle&&c.target.setY(center.y+Math.cos(c.maxPolarAngle)*distance)})).onComplete((()=>{o.control&&(c.enabled=!0),tweengroup.remove(l)})).start();tweengroup.add(r,l)}static SetState(e){c.enabled=e}static Init({canvas:e},t,n){l=t,c=new o.N(t,e),c.enabled=!0,c.enableDamping=!0,c.dampingFactor=.25,c.screenSpacePanning=!1,c.minDistance=.01,c.maxDistance=500,r=new i.ZU(t,e),r.addEventListener("dragging-changed",(e=>{c.enabled=!e.value}));const a=r.getHelper();n.add(a),r.getRaycaster().layers.set(1),a.traverse((e=>{e.layers.set(1)})),window.addEventListener("keydown",(e=>{switch(c.enabled=!e.ctrlKey,e.code){case"KeyQ":r.setSpace("local"===r.space?"world":"local");break;case"Shift":r.setTranslationSnap(1),r.setRotationSnap(s.MathUtils.degToRad(15)),r.setScaleSnap(.25);break;case"KeyW":r.setMode("translate");break;case"KeyE":r.setMode("rotate");break;case"KeyR":r.setMode("scale");break;case"KeyF":r.object&&d();break;case"KeyC":case"KeyV":case"KeyX":case"KeyY":case"KeyZ":case" ":case"Escape":break;case"+":case"=":r.setSize(r.size+.1);break;case"-":case"_":r.setSize(Math.max(r.size-.1,.1))}})),window.addEventListener("keyup",(e=>{c.enabled=!e.ctrlKey,"Shift"===e.key&&(r.setTranslationSnap(null),r.setRotationSnap(null),r.setScaleSnap(null))}))}static get Transformer(){return r}static Select(e){e?r.attach(e):r.detach()}static Update(e){c.update(e)}static FitTo({center:e,radius:t}){const n=(0,a.eh)(l.fov),o=t/Math.sin(n/2),i=(new s.Vector3).subVectors(l.position,e).normalize();!function(e,t,n=1){c.enabled=!1;const o=n,s=l.position.clone(),i=c.target.clone(),a=Date.now();!function n(){const r=(Date.now()-a)/(1e3*o);if(r>=1)return l.position.copy(e),c.enabled=!0,c.target.copy(t),void c.update();l.position.lerpVectors(s,e,r),c.target.lerpVectors(i,t,r),c.update(),requestAnimationFrame(n)}()}(e.clone().add(i.multiplyScalar(o)),e,.5)}}const h=p}}]);